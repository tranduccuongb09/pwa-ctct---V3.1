<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Xem lại & giải thích</title>
<link rel="manifest" href="manifest.webmanifest">
<style>
  :root{--brand:#a00000;--border:#e5e7eb}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:#f5f6f8;color:#111}
  .topbar{display:flex;gap:12px;align-items:center;background:var(--brand);color:#fff;padding:14px 16px}
  .topbar a{color:#fff;text-decoration:none}
  .container{max-width:980px;margin:16px auto;padding:0 12px}
  .card{background:#fff;border-radius:14px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:18px;margin:12px auto}
  .qa{border-top:1px solid var(--border);padding:12px 0}
  .qa h4{margin:0 0 6px}
  .muted{color:#6b7280}
  .ok{color:#16a34a} .ng{color:#dc2626}
</style>
</head>
<body>
  <div class="topbar">
    <a href="index.html">← Trang chủ</a>
    <strong>XEM LẠI & GIẢI THÍCH</strong>
  </div>
  <main class="container">
    <section class="card" id="box">Đang tải…</section>
  </main>
<script>
  const data = JSON.parse(localStorage.getItem('ctct_last_result_for_review')||'null');
  const box = document.getElementById('box');
  if(!data){ box.textContent='Chưa có lần nộp gần đây.'; }
  else{
    const header = `<p><b>${data.name}</b> - ${data.unit} (${data.position}) | Mã đề ${data.examCode} | ${data.score}/${data.total} điểm</p>`;
    const list = data.details.map(d=>{
      const ok = d.chosen===d.correct;
      const explain = (d.explanation||'').trim();
      return `<div class="qa">
        <h4>Câu ${d.index}</h4>
        <p>${d.question}</p>
        <p class="${ok?'ok':'ng'}">${ok?'✔ Đúng':'✘ Sai'} — Bạn chọn: <b>${d.chosen||'-'}</b> • Đúng: <b>${d.correct||'-'}</b></p>
        ${explain?`<p class="muted"><i>Giải thích:</i> ${explain}</p>`:''}
      </div>`;
    }).join('');
    box.innerHTML = header + list;
  }
</script>
</body>
</html>
